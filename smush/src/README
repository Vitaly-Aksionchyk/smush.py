smush.py - Optimise images for the web
========================================

Smush.it is a great service that applies lossless optimisations to images for display on the web. Unfortunately
they don't provide an API at the time of writing, and sometimes it's convenient to have a local tool.

smush.py uses the same tools as Smush.it (read more at:
http://oreilly.com/server-administration/excerpts/9780596522315/optimizing-images.html), but can be run
locally.

The following software is required:

  * Python 2.x >= 2.7
  * Gifsicle - http://www.lcdf.org/gifsicle/
  * ImageMagick - http://www.imagemagick.org
  * pngnq - http://pngnq.sourceforge.net/
  * pngcrush - http://pmt.sourceforge.net/pngcrush/
  * jpegtran from libjpeg

The following lossless optimisations are performed:

GIFs - If they're animated GIFs, they are optimised with Gifsicle.
       If they aren't animated, they're converted to PNGs with ImageMagick, then optimised as PNGs as below.
PNGs - Quantised with pngnq, then crushed with pngcrush.
JPGs - All EXIF data is removed (it may not be legal to remove copyright notices, so only use this on
       images you own the copyright to or that don't have copyright notices).
       If they're larger than 10kb, they're converted to progressive JPGs.
       Compression is optimised with jpegtran.

Note: If a GIF is converted to a PNG, it keeps the old .gif file extension in case the file name is in a
database.

Usage
-----

This script is intended to be run over a collection of existing images - GIFs (perhaps animated), PNGs and
JPEGs. It will perform lossless optimisations and will OVERWRITE THE ORIGINAL file. It is intended to be
able to be used to optimise images that have a reference stored in a database, hence the reason for not
modifying input file names at all.

It can be run as follows:

    python smush.py /path/to/directory(ies)

where /path/to/directory(ies) is a directory or space-separated list of directories that will be optimised.

Or type:

    python smush.py --help

for usage information.

It is safe to run this script multiple times on the same files since all operations are lossless. In fact,
PNG images may be optimised further by repeatedly smushing them.

Note: This software has only been tested on Centos 5 Linux.