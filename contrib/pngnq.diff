57a58
>    -o Specify output filename. Disables -e and -d options\n\
110c111
< static int pngnq(char* filename, char* newext, char* dir,
---
> static int pngnq(char* filename, char* newext, char* dir, char* outname,
122a124
>   char *output_file_name = NULL;
135c137
<   while((c = getopt(argc,argv,"hVvfn:s:d:e:g:Q:"))!=-1){
---
>   while((c = getopt(argc,argv,"hVvfn:s:d:e:g:Q:o:"))!=-1){
184a187,189
>     case 'o':
>       output_file_name = optarg;
>       break;
211c216
<     retval = pngnq(input_file_name, output_file_extension, output_directory,
---
>     retval = pngnq(input_file_name, output_file_extension, output_directory, output_file_name,
433c438
< static int pngnq(char* filename, char* newext, char* newdir, 
---
> static int pngnq(char* filename, char* newext, char* newdir, char* outname,
437d441
<   char *outname = NULL;
474,475c478,481
<   { 
<     outname = createoutname(filename,newext,newdir);
---
>   {
>       if (!outname) {
>         outname = createoutname(filename,newext,newdir);
>       }
673,678d678
<   /* Clean up file name */
<   if(outname){
<     free(outname);
<     outname = NULL;
<   }
< 
